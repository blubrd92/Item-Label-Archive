<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bureau of Peepy Investigation | Specimen Archive</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <!-- Marquee Alert Banner -->
  <div class="marquee-banner" id="marquee-banner">
    <marquee behavior="scroll" direction="left" scrollamount="5">
      <span id="marquee-text">/// SYSTEM STATUS: OPERATIONAL /// CLASSIFIED DOCUMENTS /// AUTHORIZED PERSONNEL ONLY /// ITEM LABEL SPECIMEN DATABASE ///</span>
    </marquee>
  </div>

  <!-- Header -->
  <header class="header">
    <h1 class="header__logo">B.P.I.</h1>
    <p class="header__subtitle">Bureau of Peepy Investigation</p>
    <p style="color: var(--hot-pink); margin-top: 10px; font-size: 0.9rem;">[ SPECIMEN ARCHIVE DATABASE ]</p>
  </header>

  <!-- Navigation -->
  <nav class="nav">
    <a href="index.html" class="nav__link nav__link--active">Specimen Gallery</a>
    <a href="fieldnotes.html" class="nav__link">Field Notes</a>
    <a href="admin.html" class="nav__link">Admin Portal</a>
  </nav>

  <!-- Main Content -->
  <main class="container">
    <!-- Filter Bar -->
    <div class="filter-bar">
      <span class="filter-bar__label">Filter by:</span>
      <select id="filter-status">
        <option value="">All Status</option>
        <option value="ACTIVE">Active</option>
        <option value="MISSING">Missing</option>
        <option value="CLASSIFIED">Classified</option>
        <option value="RETIRED">Retired</option>
      </select>
      <select id="filter-threat">
        <option value="">All Threat Levels</option>
        <option value="LOW">Low</option>
        <option value="MEDIUM">Medium</option>
        <option value="HIGH">High</option>
        <option value="CRITICAL">Critical</option>
      </select>
      <select id="sort-by">
        <option value="name">Sort: Name</option>
        <option value="date">Sort: Newest</option>
        <option value="threat">Sort: Threat Level</option>
      </select>
    </div>

    <!-- Loading State -->
    <div class="loading" id="loading">
      <div class="loading__spinner"></div>
      <p class="loading__text">Accessing Classified Database...</p>
    </div>

    <!-- Error State -->
    <div class="error-message hidden" id="error-message">
      Connection to database failed. Please try again later.
    </div>

    <!-- Empty State -->
    <div class="panel hidden" id="empty-state">
      <div class="panel__title">/// NO SPECIMENS FOUND ///</div>
      <div class="panel__content text-center">
        <p style="color: var(--cyber-green); margin-bottom: 20px;">The archive is currently empty.</p>
        <p style="color: var(--hot-pink);">Authorized personnel may add specimens via the Admin Portal.</p>
      </div>
    </div>

    <!-- Specimen Grid -->
    <div class="specimen-grid hidden" id="specimen-grid">
      <!-- Specimen cards will be dynamically inserted here -->
    </div>
  </main>

  <!-- Sneaky Peepy Easter Egg -->
  <div class="sneaky-peepy" id="sneaky-peepy">
    <div class="sneaky-peepy__body">
      <!-- Antenna with ball -->
      <div class="sneaky-peepy__antenna"></div>
      <!-- Body with cow spots -->
      <div class="sneaky-peepy__torso">
        <div class="sneaky-peepy__spot sneaky-peepy__spot--1"></div>
        <div class="sneaky-peepy__spot sneaky-peepy__spot--2"></div>
        <div class="sneaky-peepy__spot sneaky-peepy__spot--3"></div>
      </div>
      <!-- Head -->
      <div class="sneaky-peepy__head">
        <div class="sneaky-peepy__spot--head"></div>
        <!-- Cat ears -->
        <div class="sneaky-peepy__ear sneaky-peepy__ear--left"></div>
        <div class="sneaky-peepy__ear sneaky-peepy__ear--right"></div>
        <!-- Googly eyes -->
        <div class="sneaky-peepy__eyes">
          <div class="sneaky-peepy__eye">
            <div class="sneaky-peepy__pupil"></div>
          </div>
          <div class="sneaky-peepy__eye">
            <div class="sneaky-peepy__pupil"></div>
          </div>
        </div>
        <!-- Duck beak -->
        <div class="sneaky-peepy__beak"></div>
      </div>
      <!-- Yellow feet -->
      <div class="sneaky-peepy__feet">
        <div class="sneaky-peepy__foot"></div>
        <div class="sneaky-peepy__foot"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <p>BUREAU OF PEEPY INVESTIGATION &copy; <span id="year"></span></p>
    <p style="margin-top: 10px;">All specimens are property of Item Label. Unauthorized access is prohibited.</p>
  </footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <!-- App Scripts -->
  <script src="js/firebase-config.js"></script>
  <script src="js/gallery.js"></script>

  <script>
    // Set current year in footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Sneaky Peepy Easter Egg - Konami Code
    (function() {
      const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
      let konamiIndex = 0;
      let peepyRunning = false;

      document.addEventListener('keydown', function(e) {
        if (peepyRunning) return;

        const key = e.key.toLowerCase() === e.key ? e.key : e.key;
        const expected = konamiCode[konamiIndex].toLowerCase() === konamiCode[konamiIndex]
          ? konamiCode[konamiIndex]
          : konamiCode[konamiIndex];

        if (e.key === expected) {
          konamiIndex++;
          if (konamiIndex === konamiCode.length) {
            triggerPeepy();
            konamiIndex = 0;
          }
        } else {
          konamiIndex = 0;
        }
      });

      function triggerPeepy() {
        peepyRunning = true;
        const peepy = document.getElementById('sneaky-peepy');
        peepy.classList.add('animate');

        // Add startled class partway through for faster run
        setTimeout(() => {
          peepy.classList.add('startled');
        }, 4800);

        // Reset after animation
        setTimeout(() => {
          peepy.classList.remove('animate', 'startled');
          peepyRunning = false;
        }, 8000);
      }
    })();
  </script>
</body>
</html>
